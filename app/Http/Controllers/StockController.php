<?php
 namespace App\Http\Controllers; use App\Models\products; use App\Models\stock; use App\Models\units; use App\Models\warehouses; use Illuminate\Http\Request; class StockController extends Controller { public function index() { $products = products::all(); $warehouses = warehouses::all(); return view("\163\x74\x6f\x63\153\56\151\x6e\x64\x65\170", compact("\x70\x72\157\x64\165\143\x74\163", "\x77\141\162\x65\x68\x6f\x75\163\145\x73")); } public function create() { } public function store(Request $request) { } public function show($id, $warehouse, $from, $to) { $product = products::find($id); if ($warehouse == "\x61\154\154") { $stocks = stock::where("\x70\162\157\144\165\143\x74\111\x44", $id)->whereBetween("\x64\141\x74\145", array($from, $to))->get(); $pre_cr = stock::where("\160\162\x6f\144\x75\143\x74\x49\104", $id)->whereDate("\x64\x61\164\145", "\x3c", $from)->sum("\x63\x72"); $pre_db = stock::where("\x70\x72\x6f\x64\165\143\164\111\104", $id)->whereDate("\144\141\x74\x65", "\74", $from)->sum("\x64\142"); $cur_cr = stock::where("\160\162\x6f\x64\x75\x63\164\x49\x44", $id)->sum("\143\162"); $cur_db = stock::where("\160\162\157\144\165\143\x74\111\x44", $id)->sum("\x64\x62"); } else { $stocks = stock::where("\160\162\x6f\144\165\x63\x74\111\104", $id)->whereBetween("\144\141\164\145", array($from, $to))->where("\167\141\162\145\150\x6f\x75\163\145\111\x44", $warehouse)->get(); $pre_cr = stock::where("\160\162\x6f\144\165\x63\x74\x49\x44", $id)->whereDate("\144\141\164\x65", "\74", $from)->where("\167\x61\162\x65\150\x6f\165\163\x65\x49\x44", $warehouse)->sum("\x63\162"); $pre_db = stock::where("\160\162\x6f\144\165\143\x74\x49\104", $id)->whereDate("\144\x61\164\x65", "\x3c", $from)->where("\x77\141\162\x65\150\x6f\x75\163\x65\x49\104", $warehouse)->sum("\144\x62"); $cur_cr = stock::where("\x70\162\157\x64\165\x63\164\111\x44", $id)->where("\167\141\162\x65\x68\157\165\x73\x65\111\x44", $warehouse)->sum("\143\x72"); $cur_db = stock::where("\160\x72\x6f\144\165\x63\x74\111\x44", $id)->where("\167\141\162\145\150\157\165\163\x65\x49\104", $warehouse)->sum("\x64\142"); } $pre_balance = $pre_cr - $pre_db; $cur_balance = $cur_cr - $cur_db; return view("\163\x74\157\x63\153\56\x64\145\164\141\x69\154\163", compact("\x70\x72\x6f\144\x75\143\164", "\160\x72\x65\x5f\x62\x61\154\x61\156\143\145", "\x63\x75\x72\137\x62\x61\x6c\141\x6e\x63\x65", "\163\164\157\x63\x6b\x73", "\146\162\157\x6d", "\164\157")); } public function edit(stock $stock) { } public function update(Request $request, stock $stock) { } public function destroy(stock $stock) { } }
